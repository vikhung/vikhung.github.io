<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <meta charset="utf-8">
    <title>Vik Blog</title>
  </head>
  <body>
    <div class="container">
      <!--Bootstrape col 預設為12格-->
      <div class="row" >
        <div class="col py-3 border bg-light">
          20200108
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          1.建立BLOG步驟
        </div>
        <div class="col py-3 border bg-light">
          (1)登入Blog，並且建立新Repository，名稱為vikhung.github.io<BR>
          (2)新增index.html<BR>
          (3)測試，https://vikhung.github.io<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          2.PC端版控
        </div>
        <div class="col py-3 border bg-light">
          (1)下載Github Desktop<BR>
          (2)於Github上將vikhung.github.io Repository Clone至PC<BR>
          (3)此時，可於PC端之Github Desktop進行版控<BR>
          (4)測試，開啟編輯器修改index.html檔案，並於Github Desktop將檔案先Commit，再Fetch Orig<BR>
          (5)於Github server確認。版本是否已更新至Server端。
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          3.Visual Studio Code編輯及版控
        </div>
        <div class="col py-3 border bg-light">
          (1)於Github Desktop中開啟"Open in Visual Studio Code"，系統會開啟Visual Studio Code<BR>
          (2)在"Explore"中修改index.html<BR>
          (3)在"Source Control"會出現檔案異動符號<BR>
          (4)在"Source Control"將檔案先stage change(點選+號)(還不太會用，這有點像是先少量儲存？)<BR>
          (5)每次少少異動後，可以陸續stage change<BR>
          (6)在"Source Control"執行Commit並輸入註解(點選打勾符號)(此時尚未Push到Server)<BR>
          (7)在"Source Control"執行Push(開啟...，並點選Push)<BR>
          (8)測試，於Github server確認。版本是否已更新至Server端。<BR>
        </div>
      </div>
      <div class="row" >
        <div class="col py-3 border bg-light">
          20200111
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          1.練習Bootstrape 4
        </div>
        <div class="col py-3 border bg-light">
          (1)連結https://getbootstrap.com/，按下Get Started
          (2)參考範例，逐一新增link、script、meta...等基礎的html結構<BR>
          (3)測試，https://vikhung.github.io<BR>
        </div>
      </div>
      <div class="row" >
        <div class="col py-3 border bg-light">
          20200121
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          安裝Chrome OS from ClounReady<BR>
          如果家裡有舊NB，可以用以下方法安裝ChromOS
        </div>
        <div class="col py-3 border bg-light">
          一、製作USB開機碟<BR>
          (1)下載CloudReady For personal, home use版本的ChromOS安裝工具(https://www.neverware.com/#get-cloudready)<BR>
          (2)點選Get The Free Version，再點選Download USB Maker，下載可製作USB開機碟的安裝工具(cloudready-usb-maker.exe)<BR>
          (3)執行cloudready-usb-maker.exe開始製作開機USB(基本上就是一直按Next<BR>
          二、開機<BR>
          (1)USB插入後開機，先選擇語系後、設定網路(之前安裝經驗，因為我的NB網卡找不到Driver了(懶的找)，但補上一支WIFI USB碟後也可以)<BR>
             PS.如果沒有網路，先跳過網路安裝步驟，後續再插上WIFI網卡也行<BR>
          (2)正式登入後，可以點選右下角功能，執行Install OS。此時會開始將ChromOS安裝到硬碟(約20分鐘)<BR>
          (3)拔掉USB重新開機，改由硬碟開機，這時候可以像操作Android一般，於設定功能中，將Linux安裝完成，這又就可以使用Google包裝的Linux版本<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          一、Chrome OS Linux安裝OpenJDK<BR>
          二、Chroms OS Linux安裝mongoDB<BR>
          三、Ubutun 安裝mongoDB<BR>
        </div>
        <div class="col py-3 border bg-light">
          一、OpenJDK<BR>
          (1)sudo apt-get update<BR>
          (2)sudo apt-get upgrade<BR>
          (3)sudo apt-get install openjdk-8-jdk<BR>
          二、mongoDB<BR>
          (1)以下是針對ChromOS的Linux進行安裝<BR>
          (2)主要安裝程序是參考https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/<BR>
          (3)指令：apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv EA312927<BR>
          (4)指令：echo "deb http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/4.2 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.2.list<BR>
          (5)指令：apt-get update<BR>
          (6)指令：apt-get install -y mongodb<BR>
             PS.官方文件ubuntu步驟是apt-get install -y mongodb，但我安裝失敗，改成apt-get install -y mongo竟意外成功了，但是版本似乎是3.2.11版，但先能用再說<BR>
          (7)指令：啟動服務：sudo service mongodb start<BR>
          (8)指令：停止服務：sudo service mongodb stop<BR>
          (9)指令：服務狀態：sudo service mongo status<BR> 
             PS.官方文件是sudo service mongoddb start，但是這裡必須用mongo<BR>
          (10)測試：執行mongo，接著執行db，如果有看到test，就成功了<BR>
          ...<BR>
          QA：到底ChromOS是基於哪種安裝？因為官方文件只有針對主流Linux提供安裝程序，所以裝起來版本不太一樣<BR>
          後來檢查版本看來是3.12版的<BR>
          三、mongoDB(Ubutun)<BR>
          (1)完全依照官方文件即可，一模一樣<BR>
        </div>
      </div>
      <div class="row" >
        <div class="col py-3 border bg-light">
          20200124
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          mongoDB(Ubutun) study<BR>
          Install<BR>
        </div>
        <div class="col py-3 border bg-light">
          1.Directories<BR>
          安裝完後兩個重要位置，/var/lib/mongodb、/var/log/mongodb，前者放置資料，後者放置log，如果有新增使用者帳號，也要調整這兩個目錄權限。<BR>
          By default, MongoDB runs using the mongodb user account. If you change the user that runs the MongoDB process, you must also modify the permission to the data and log directories to give this user access to these directories.<BR>
          2.Configuration File<BR>
          The official MongoDB package includes a configuration file (/etc/mongod.conf). These settings (such as the data directory and log directory specifications) take effect upon startup. That is, if you change the configuration file while the MongoDB instance is running, you must restart the instance for the changes to take effect.<BR>
          3.Procedure<BR>
          sudo service mongod start<BR>
          sudo service mongod status<BR>
          sudo service mongod stop<BR>
          sudo service mongod restart<BR>
          mongo<BR>
        </div>
      </div>
      <div class="row" >
        <div class="col py-3 border bg-light">
          20200127
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          mongoDB(Ubutun) study<BR>
          連線方式<BR>
        </div>
        <div class="col py-3 border bg-light">
          這幾天稍微玩了一下mongodb，本機操作都沒問題，不過只要遠端就會失敗，找了一下資料，發現應該是要將實際IP寫入設定檔中。<BR>
          (一)參考文件：https://docs.mongodb.com/manual/reference/configuration-options/#net.bindIp<BR>
          (二)設定檔位置(記得先備份)<BR>
          先確認本機IP ==>ifconfig<BR>
          1.Windows：(mongo安裝位置)\Server\4.0\bin\mongod.cfg<BR>
          2.ubutun：/etc/mongod.conf<BR>
          (三)修改設定檔<BR>
          1.sudo gedit /etc/mongod.conf<BR>
          2.修改:bindIp:127.0.0.1 ==> bindIp:127.0.0.1,192.168.0.34<BR>
          3.存檔離開<BR>
          4.啟動mongodb<BR>
          5.sudo service mongod start<BR>
          (四)確認使否有效<BR>
          可透過log看是否有listen指定的IP，log檔位置<BR>
          (1)Windows：(mongo安裝位置)\Server\4.0\log\mongod.log<BR>
          (2)ubutun：/var/log/mongodb/mongod.log<BR>
          (四)連實際線測試<BR>
          開始Windows版的Mongodb Compass連線測試工具，確認已可連接。<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          mongoDB(Ubutun) study<BR>
          Replication<BR>
        </div>
        <div class="col py-3 border bg-light">
          參考資料：https://docs.mongodb.com/manual/replication/<BR>
          Replication模式中，如果Second Host沒有接收到Primary Host heartbeat，預設時間為10秒，會重新投票(Elect)選擇新主機作為Primary Host<BR>
          一.Replica Set Members<BR>
            https://docs.mongodb.com/manual/core/replica-set-members/<BR>
            (二)Replica Set Secondary Members(三種應用方式)<BR>
              https://docs.mongodb.com/manual/core/replica-set-secondary/<BR>
              設定為priority 0的Secondary Host不能參與投票，也就是不能變為Primary，有三種應用方式(官方介紹)。<BR>
              1.Priority 0 Replica Set Members：應用於異地備援(Sandby)，https://docs.mongodb.com/manual/core/replica-set-priority-0-member/<BR>
              2.Hidden Replica Set Members：：應用於提供特定讀取用途，https://docs.mongodb.com/manual/core/replica-set-hidden-member/<BR>
              3.Delayed Replica Set Members：應用於固定備存晚於當前時間的應用，如故意延後備存保持60分鐘，假設現在是21:00，那該主機只保留20:00前的資料，這樣可用於保護這一小時間的人為錯誤操作。https://docs.mongodb.com/manual/core/replica-set-delayed-member/<BR>
            (三)Replica Set Arbiter<BR>
              https://docs.mongodb.com/manual/core/replica-set-arbiter/<BR>
              不要讓Primary or Secondary Host同時兼任仲裁者<BR>
              Arbiter不會留存資料<BR>
          二.Replica Set Deployment Architectures<BR>
            https://docs.mongodb.com/manual/core/replica-set-architectures/<BR>
            Deploy an Odd Number of Members<BR>
            A replica set can have up to 7 voting members.<BR>
            <B>In general, avoid deploying more than one arbiter per replica set.</B><BR>
            (一)Three Member Replica Sets<BR>
            https://docs.mongodb.com/manual/core/replica-set-architecture-three-members/<BR>
            The minimum number of replica set members needed to obtain the benefits of a replica set is three members(最少要三個)<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          mongoDB(Ubutun) study<BR>
          Replication Testing<BR>
        </div>
        <div class="col py-3 border bg-light">
          一、準備三台環境,並各自驗證成功<BR>
            1.準備相關設定:用同一台Linux主機，用三個Port模擬RS三台，並準備相關的設定檔,資料庫檔,log檔<BR>
              192.168.0.34 27111 ==> config:/etc/mongod-rs1-p1.conf, db:/var/lib/mongodb-rs1-p1, log:/var/log/mongodb<BR>
              192.168.0.34 27112 ==> config:/etc/mongod-rs1-s1.conf, db:/var/lib/mongodb-rs1-s1, log:/var/log/mongodb<BR>
              192.168.0.34 27113 ==> config:/etc/mongod-rs1-s2.conf, db:/var/lib/mongodb-rs1-s2, log:/var/log/mongodb<BR>
            2.修改設定檔(先備份)<BR>
              將上述三個設定檔,分別調整相關環境參數<BR>
              (1)storage.dbPath: /var/lib/mongodb-rs1-p1<BR>
              (2)net.port: 27111<BR>
              (3)net.bindIp: 將實體ip加入,方便等會跨主機發動Insert(如果沒有跨主機,是不用加)<BR>
            3.主機驗證<BR>
              (1)啟動服務(&:加入背景): sudo mongod --config /etc/mongod-rs1-p1.conf &<BR>
              (2)確認是否真的登入該主機: sudo tail -f /var/log/mongodb<BR>
              (3)新增一筆<BR>
              sudo mongo --host 192.168.0.34 --port 27111<BR>
              db.collection.insert({"x":1})<BR>
          二、設定RS<BR>
            我參考下面這一篇，但官網的應該比較新<BR>
            民間版:3.x版:https://blog.toright.com/posts/4508/mongodb-replica-set-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7%E6%9E%B6%E6%A7%8B%E6%90%AD%E5%BB%BA.html<BR>
            官網:4.x版:https://docs.mongodb.com/manual/tutorial/deploy-replica-set/<BR>
            1.開啟三個服務的設定檔，將replication.replName均設定為 "rs1" <BR>
              replication:<BR>
                replSetName: "rs1"<BR>
            2.重新啟動三組服務<BR>
              sudo mongod --config /etc/mongod-rs1-p1.conf &<BR>
              sudo mongod --config /etc/mongod-rs1-s1.conf &<BR>
              sudo mongod --config /etc/mongod-rs1-s2.conf &<BR>
            3.登入第一台<BR>
              sudo mongo --host 192.168.0.34 --port 27111<BR>
            4.試著查詢先前新增的資料，出現錯誤， "errmsg" : "not master and slaveOk=false",<BR>
              看來應該是設定檔已經設定為rs1，但尚未初始化<BR>
            5.正式設定<BR>
              use admin<BR>
              rs.initiate() ==> 會看到OK，提示符號會變成  rs1:SECONDARY><BR>
              rs.conf() ==> 會看到像是成功的訊息，這時候提式符號再度變成 rs1:PRIMARY><BR>
              rs.add("192.168.0.34:27112")<BR>
              rs.add("192.168.0.34:27113")<BR>
              rs.status() ==> 確認RS狀況，從member中看到共有三台主機,分別為Primary,Secondary,Secondary<BR>
              PS.我多打rs.conf() 沒發生啥事<BR>
          三、做實驗<BR>
              (一)程序<BR>
                1.登入第一台<BR>
                  sudo mongo --host 192.168.0.34 --port 27111   ==> 這時候提式符號已經變成rs1:PRIMARY><BR>
                2.新增三筆資料<BR>
                  rs1:PRIMARY>db.collection.insert({"x":1})<BR>
                  rs1:PRIMARY>db.collection.insert({"x":2})<BR>
                  rs1:PRIMARY>db.collection.insert({"x":3})<BR>
                3.嘗試從第二台觀察<BR>
                  sudo mongo --host 192.168.0.34 --port 27112   ==> 這時候提式符號已經變成rs1:SECONDARY><BR>
                  出現查詢失敗 "errmsg" : "not master and slaveOk=false",<BR>
                  看來只允許從PRIMARY處理，但或許調整slaveOk=true後，可以從其他台查詢/新增<BR>
                4.關閉第一台主機<BR>
                  jobs   (找出剛才背景執行的服務)<BR>
                  fg %n  (拉回前景)<BR>
                  Ctrl+c (終止服務)<BR>
                5.再從第二台觀察<BR>
                  sudo mongo --host 192.168.0.34 --port 27112   ==> 這時候提式符號已經變成rs1:PRIMARY><BR>
                  執行查詢指令<BR>
                  db.collection.find()<BR>
                  { "_id" : ObjectId("5e2efa048dd017fe08c02dfe"), "x" : 1 }<BR>
                  { "_id" : ObjectId("5e303cc92834a7c5afa3881f"), "x" : 2 }<BR>
                  { "_id" : ObjectId("5e303cd02834a7c5afa38820"), "x" : 3 }<BR>
                  ==>證明資料有確實Replicat過去第二台<BR>
                6.關閉第一台主機<BR>
                  同上指令<BR>
                7.改從第三台觀察<BR>
                  sudo mongo --host 192.168.0.34 --port 27113   ==> 這時候提式符號已經變成rs1:SECONDARY><BR>
                  執行查詢指令 db.collection.find() ==> 失敗，表示3台掛兩2台，就無法運作了，而且也選不出PRIMARY<BR>
                8.重新啟動第一台，再登入第三台(目前狀態,P1,S2-PRIMARY)<BR>
                  這時候第三台提式符號已經變成rs1:PRIMARY>，表示起一台後可以重新投票了<BR>
                9.重新啟動第二台，關閉第三台(目前狀態,P1-PRIMARY,S1)<BR>
                  這時候PRIMARY又變回第一台了<BR>
                10.目前只有兩台情況下，從第一台再新增一筆資料<BR>
                   rs1:PRIMARY>db.collection.insert({"x":4})<BR>
                11.因為SECONDARY尚無法查資料,想辦法讓第三台變Primary再查詢<BR>
                   開啟第三台(目前狀態,P1-PRIMARY,S1,S2)<BR>
                   關閉第一台(目前狀態,S1-PRIMARY,S2)<BR>
                   關閉第二台(目前狀態,S2)<BR>
                   開啟第三台(目前狀態,P1,S2-PRIMARY)<BR>
                12.執行查詢指令 db.collection.find()<BR>
                   發現到剛才新增的第四筆資料<BR>
                   ==>證明當其中一台主機於停機後再開機時，其他主機也會將資料同步過去(全自動)<BR>
              (二)發現<BR>
                <u>待實驗</u><BR>
                1.只能從PRIMARY新增，但如果第一台掛了，前端怎麼知道改連第二台<BR>
                  是否要有NLB提供VIP?<BR>
                  抑或mongodb有VIP機制(尚未參透)?<BR>
                  抑或連線字串可以設定多組(jdbc)(尚未測試)?<BR>
                2.怎樣可以讓第二台可以只做查詢(讀寫分離之類)(應該可以調整參數)(待測試)<BR>
                3.掛兩台，只剩一台為何不能就選自己當PRIMARY呢，可否設定？<BR>
                4.用AP打交易,新增
                5.認證機制
                <u>證明</u><BR>
                1.證明資料有確實Replicat過去第二台<BR>
                2.證明當其中一台主機於停機後再開機時，其他主機也會將資料同步過去(全自動)<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          Mongo 常用語法<BR>
        </div>
        <div class="col py-3 border bg-light">
          1.show dbs ==> List所有Database<BR>
          2.show collections ==> List所有Collection<BR>
          3.db ==>列出目前始在哪個DB<BR>
          4.db.kocha.count() ==> 找出筆數<BR>
          5.db.kocha.drop() ==> 砍掉Collection<BR>
          6.db.kocha.find({hospName:"遵龍藥局"})<BR>
          Like查詢方法<BR>
          7.db.kocha.find({hospTel:{'$regex': '(04)'}})<BR>
          8.db.kocha.find({createDate:{'$regex': '20200218095'}})<BR>
          9.db.kocha.find({"createDate":/2020/})<BR>
          10.db.kocha.find({"hospTel":/255/})<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          Mongo Java Sample<BR>
        </div>
        <div class="col py-3 border bg-light">
          一、參考位置：https://mongodb.github.io/mongo-java-driver/3.12/driver/getting-started/installation/<BR>
          二、jdbc下載位置：https://oss.sonatype.org/content/repositories/releases/org/mongodb/mongodb-driver-sync/3.12.1<BR>
            1.mongodb-driver-core-3.12.1.jar<BR>
            2.mongodb-driver-sync-3.12.1.jar<BR>
            3.bson-3.12.1.jar<BR>
          三、logging是採用slf4j機制<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          Java Maven Study<BR>
        </div>
        <div class="col py-3 border bg-light">
          透過Maven下載管理java套件<BR>
          一、開始方式<BR>
            (一)Eclipse(新專案)<BR>
              (以下僅限開放式開發環境)<BR>
              1.開啟新專案就引入maven，可參考：https://matthung0807.blogspot.com/2018/03/maven.html<BR>
              2.依上述步驟新增專案後，測試一下<BR>
                (1)以mongoDB為例，加入mongodb jdbc，可參考https://mongodb.github.io/mongo-java-driver/3.12/driver/getting-started/installation/<BR>
                (2)打開pom.xml，於dependencies中加入<BR>
                <dependencies><BR>
                  <dependency><BR>
                      <groupId>org.mongodb</groupId><BR>
                      <artifactId>mongodb-driver-sync</artifactId><BR>
                      <version>3.12.1</version><BR>
                  </dependency><BR>
                </dependencies><BR>
                (3)很神奇的，專案自動將1.mongodb-driver-core-3.12.1.jar、2.mongodb-driver-sync-3.12.1.jar、3.bson-3.12.1.jar都下載完成了<BR>
            (二)EclipseOld新專案)<BR>
              於Eclipse/Propect Preference點選Configure/Convert to MAVEN<BR>
              參考：https://www.itread01.com/content/1544752507.html<BR>
              ...有點麻煩,先放棄[TODO]，有需要的話下次再研究<BR>
          二、使用方式<BR>
            1.可以到maven Repository看最新版本<BR>
              https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-slf4j-impl/2.13.0<BR>
            2.可以在Pom.xml中維護所需版本，eclipse會自動下載相關的jar檔<BR>
            3.Ex<BR>
              <dependency><BR>
               <groupId>org.apache.logging.log4j</groupId><BR>
                <artifactId>log4j-slf4j-impl</artifactId><BR>
                <version>2.13.0</version><BR>
              </dependency><BR>
              可以自行更改版本號，eclipse會自動去下載<BR>
              PS.Console應該要自己執行maven相關程式吧<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          SLF4j(Simple Logging Facade for Java)簡介<BR>
          20200216 Vik(end)<BR>
        </div>
        <div class="col py-3 border bg-light">
          1.參考<BR>
            https://www.ithome.com.tw/voice/117126<BR>
            https://www.liaoxuefeng.com/wiki/1252599548343744/1264739155914176<BR>
          2.log4j作者是Ceki Gülcü<BR>
            過往日誌機制有log4j、JUL(java.util.logging)等，後來Apache出了一組Apache Commons Logging當作入口介面，讓AP可以透過Apache Commons Logging切換log4j or 過往日誌機制有log4j、JUL<BR>
            但是Apache Commons Logging的動態綁定規則太複雜，因此log4j作者有出了一套SLF4j的套件，目的和Apache Commons Logging。都是提供入口介面<BR>
          2.SLF4J作者也是Ceki Gülc<BR>
            SLF4j是一組介面，可充作log4j及JUL的介面<BR>
          3.Logback作者也是Ceki Gülc，是一套實作SLF4J介面的座實作<BR>
          4.log4j後來看到SLF的發展，也在2014年提出log4j2，將介面與實作分離分為log4j-api、log4j-core，舊log4j 2015年也不再出版了<BR>
          5.設定檔關係<BR>
            JUL：僅支援.properties<BR>
            Log4j、Logback、Log4j2 Core：可使用.properties、XML、Groovy（Logback）<BR>
            Log4j2：JSON，不支援.properties<BR>
          6.log日誌使用方式<BR>
            (1)SLF4j<BR>
              import org.slf4j.Logger;<BR>
              import org.slf4j.LoggerFactory;<BR>
              private static Logger logger = LoggerFactory.getLogger(GetKOCHA.class);<BR>
              Maven配置<BR>
              =========<BR>
              <dependency><BR>
                <groupId>org.apache.logging.log4j</groupId><BR>
                <artifactId>log4j-slf4j-impl</artifactId><BR>
                <version>2.11.0</version><BR>
              </dependency><BR>
            (2)log4j2<BR>
              import org.apache.logging.log4j.LogManager;<BR>
              import org.apache.logging.log4j.Logger;<BR>
              private static Logger logger = LogManager.getLogger(GetKOCHA.class);<BR>
              Maven配置<BR>
              <dependency><BR>
                <groupId>org.apache.logging.log4j</groupId><BR>
              <artifactId>log4j-api</artifactId><BR>
              <version>2.13.0</version><BR>
              </dependency><BR>
              <dependency><BR>
                <groupId>org.apache.logging.log4j</groupId><BR>
                <artifactId>log4j-core</artifactId><BR>
                <version>2.13.0</version><BR>
              </dependency><BR>
              PS.因為mongodb是使用slf4j,因此如果用這機制,mongodb的log沒辦法控制...<BR>
          7.設定檔完全可以共用上述兩種(SLF4J、log4j2)配置<BR>
            (1)log4j2.xml<BR>
            <code>
            <Configuration status="WARN" monitorInterval="600"><BR>
              <Appenders><BR>
                <Console name="Console" target="SYSTEM_OUT"><BR>
                  <PatternLayout pattern="%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"/><BR>
                </Console><BR>
              </Appenders><BR>
              <Loggers><BR>
                <Root level="debug"><!-- Root is DEBUG Level --><BR>
                  <AppenderRef ref="Console"/><BR>
                </Root><BR>
                <Logger name="org.mongodb" level="info"><!-- MongoDB is INFO Level --><BR>
                  <AppenderRef ref="Console"/><BR>
                </Logger><BR>
              </Loggers><BR>
            </Configuration><BR>
            </code>
            (2)log4j2.properties<BR>
              name = kocha<BR>
              rootLogger.level = trace<BR>
              rootLogger.appenderRef.stdout.ref = STDOUT<BR>
              appender.console.type = Console<BR>
              appender.console.name = STDOUT<BR>
              appender.console.layout.type = PatternLayout<BR>
              appender.console.layout.pattern = [%d{yyyy/MM/dd HH:mm:ss:SSS}] [%p] [%c{1}:%L] - %m%n<BR>
              appender.console.filter.threshold.type = ThresholdFilter<BR>
              appender.console.filter.threshold.level = info<BR>
          6.log模板<BR>
            (1)舊方法<BR>
               logger.info("Insert " + list.size() + " record into OpenData DB spend time : " + (t2-t1) + "ms");<BR>
            (2)新方法<BR>
               logger.info("Insert {} record into {} DB spend time : {} ms",<BR>
                           getProperties(PROP_MONGO_DB),<BR>
                           list.size(),<BR>
                           t2-t1);<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          一、Linux環境連結Github方法<BR>
          二、Eclipse With Github<BR>
          20200216 Vik(end)<BR>
        </div>
        <div class="col py-3 border bg-light">
          一、Linux環境連結Github方法<BR>
          1.參考<BR>
            https://www.liquidweb.com/kb/create-clone-repo-github-ubuntu-18-04/<BR>
          2.步驟<BR>
            git config --global user.name "vikhung"<BR>
            git config --global user.email "vikhung@gmail.com"<BR>
            mkdir VikGitHub<BR>
            cd VikGitHub<BR>
            git clone https://github.com/username/want-some-java.gitv(將github url下載)<BR>
            輸入帳號密碼，自動下載到對應目錄<BR>
          二、Eclispe With Github<BR>
          1.開啟Eclipse<BR>
          2.Import專案，選用已存在的Eclipse專案<BR>
          3.如果該專案目錄是從github下載，那Eclipse會自動支援<BR>
        </div>
      </div>
      <div class="row" >
        <div class="col py-3 border bg-light">
          20200220
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          Slack Web Hook<BR>
          20200220 Vik<BR>
          其實還有另一種複雜版，請搜尋Slack API<BR>
        </div>
        <div class="col py-3 border bg-light">
          1.申請Slack APP<BR>
            https://slack.com/signin?redir=/apps<BR>
          2.輸入Workspace<BR>
            Ex:fiscnw<BR>
          3.Create APP https://api.slack.com/apps<BR>
            Ex:VikSlackApp<BR>
          4.點遠APP圖示，進入Basic Information<BR>
          5.新增Web Hook<BR>
            點選Add features and functionality<BR>
            點選Incomng Web Hook<BR>
            新增Web Hook<BR>
          6.這時候，Slack會給針對#channel給一串URL<BR>
            https://hooks.slack.com/services/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<BR>
            另外，只要依據下列格式，即可將訊息拋送給Slack<BR>
            curl -X POST -H 'Content-type: application/json' --data '{"text":"Hello, World!"}' https://hooks.slack.com/services/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<BR>
        </div>
      </div>

      <div class="row">
        <div class="col-3 py-3 border bg-light">
          Spring Boot For Web(kocha)
        </div>
        <div class="col py-3 border bg-light">
          一、步驟
            1.Open Eclipse
            2.Create new project "Spring Started Project"
              Service url : default
              Name : kochaWeb
              Location : (Local PC path)
              Group : com.vik
              Artiface : kochaWeb(同Name)
              Package : com.vik
            3.選擇元件 : Web、NoSQl-MongoDB、Spring boot for apache kafka..
            4.Finish
          二、執行方式
            1.Eclispe中專案執行
            2.DOS D:\>mvn spring-boot:run
            3.jar
              (1)D:\>mvn packege
              (2)java -jar xxx.jar
          三、Browser測試
            http://localhost:8080
            (會出現錯誤，因為SpringBoot尚未指定Controller)
          四、新增Controller，並重新測試http://localhost:8080/sayHello
            package com.vik.kocha;
            import org.springframework.stereotype.Controller;
            import org.springframework.web.bind.annotation.GetMapping;
            import org.springframework.web.bind.annotation.PostMapping;
            import org.springframework.web.bind.annotation.RequestMapping;
            import org.springframework.web.bind.annotation.RequestMethod;
            import org.springframework.web.bind.annotation.RestController;
            @RestController
            @RequestMapping("/kocha/v1.0.0")
            public class KochaController {
              
              //@RequestMapping(value = "/sayHello", method = RequestMethod.GET)	
	            //@RequestMapping("/sayHello")
              @GetMapping("/sayHello")
              public String hello()
              {
                return "Hello Spring Boot!!";
              }

              @GetMapping("/dbCount")
              public String count()
              {
                return "20";
              }
            }
          五、HTML模板
            如果要顯示頁面的話，要建立一個可以對應的模板
            1.@@RestController 改為 @Controller
            2.POM.xml 新增
            <dependency>
              <groupId>org.springframework.boot</groupId>
              <artifactId>spring-boot-starter-thymeleaf</artifactId>
            </dependency>
            3.於resources/emplates中新增一個html頁面模板
              kochas.html
            4.new method
            @GetMapping("/kochas")
            public Object getAll()
            {
              return "kochas";  //這裡必須和html檔名相同
            }
          PS.參考資料
          1.https://www.ruanyifeng.com/blog/2011/09/restful.html (理解RESTful架构/阮一峰)
          2.http://www.ruanyifeng.com/blog/2014/05/restful_api.html (RESTful API 设计指南/阮一峰)
        </div>
      </div>

      <div class="row">
        <div class="col-3 py-3 border bg-light">
          Sample
        </div>
        <div class="col py-3 border bg-light">
          Sample Detail
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          Git command
        </div>
        <div class="col py-3 border bg-light">
          1.git status
          2.git add -a (將全部檔案加入local staging)
            git add -a -f (將全部檔案加入local resp，避免ignore)
          3.gti commit -a (將全部檔案加入local resp)
            git commit -s (加上簽名)
            git commit --allow-empty (加個log)
          4.git push -u origin master (Push 到 remote)
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          Linux 常用指令或問題<BR>
        </div>
        <div class="col py-3 border bg-light">
          1.放入背景 + &<BR>
            Ex: sudo mongod /etc/mongod-rs1-p1.conf &<BR>
          2.jobs : 觀察有哪些背景服務<BR>
          3.fg %5 : 將第5個背景服務放到前景<BR>
          4.Ctrl+Z : 暫停進入背景<BR>
          5.bg %5 : 重新執行背景服務<BR>
          6.kill %5 : 刪除背景服務(PS ubutun試驗無效)<BR>
          7.nohup : 強制背景服務<BR>
          8.如果要讓Windows可以遠端登入ubutun，需要先安裝opsnssl-server<BR>
            http://blog.udn.com/nigerchen/2262865<BR>
          9.如果apt-get要透過SSL下載軟體，那得先安裝apt-transport-htts<BR>
          10.開啟Syslog<BR>
            (1)檢查/etc/rsyslog.conf是否開啟相關Port<BR>
               udp/tcp 打開<BR>
            (2)檢查 : sudo service rsyslog status<BR>
            (3)啟動 : sudo service rsyslog start<BR>
          11.cron<BR>
            (1)啟動 : sudo service cron start<BR>
            (2)新增 job<BR>
               crontab -e<BR>
               EX:<BR>
               */1 * * * * /bin/sh /home/vik/VikGitHub/VikCode/linux/a01-1.sh >> myLog.txt<BR>
               重點:<BR>
               /1 1分鐘<BR>
               /bin/sh 用這個命令來執行shell<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          Linux 安裝AP SOP<BR>
        </div>
        <div class="col py-3 border bg-light">
          1.java : sudo apt install openjdk-11-jdk<BR>
          2.jq<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          Minikube安裝sudo apt-get install -y kubectl程序<BR>
        </div>
        <div class="col py-3 border bg-light">
          1.安裝kubectl工具<BR>
            (1)sudo apt-get install -y kubectl<BR>
          2.安裝minikube<BR>
            (1)curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64<BR>
            (2)chmod +x minikube<BR>
            (3)sudo cp minikube /usr/local/bin/<BR>
            (4)rm minikube<BR>
          3.啟動minikube<BR>
          minikube start --driver=docker<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          elasticsearch logstash kibana 8.1 install<BR>
        </div>
        <div class="col py-3 border bg-light">
          <U>install elasticsearch(for ubuntu)</U><BR>
          https://www.elastic.co/guide/en/elasticsearch/reference/8.1/deb.html#deb-repo<BR>
          以下動作均在Acer NB實驗過<BR>
          1$wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg<BR>
          2$sudo apt-get install apt-transport-https<BR>
          3$echo "deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/8.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-8.x.list<BR>
          4$sudo apt-get update && sudo apt-get install elasticsearch<BR>
          裝完後會產生elastic這個預設帳號的密碼要存起來<BR>
          5$sudo systemctl enable elasticsearch.service    啟動為服務狀態<BR>
          6$sudo systemctl start elasticsearch.service    啟動服務<BR>
          7$sudo curl --cacert /etc/elasticsearch/certs/http_ca.crt -u elastic https://localhost:9200  檢查服務<BR> 
            如果用一般使用者sudo安裝，會看不到certs目錄，故加上sudo<BR>
          <div>&nbsp</div>
          <U>remove elasticsearch</U><BR>
          有發生，如果本來安裝ES7.1x，後來移除ES7改安裝ES8，但ES8無法啟動，查錯誤訊息是ES7無法join進ES8，因此看是要upgradeES7資料，不然就移ES7乾淨<BR>
          1$cat /etc/os-release 檢查版本<BR>
          2$curl http://localhost:9200/_cluster/health?pretty 確認ES是否執行<BR>
          3$jps | grep elasticsearch 確認是否有ES的jvm<BR>
          4$ps -ef | grep elastic<BR>
          5$sudo apt remove elasticsearch   移除ES<BR>
          6$sudo apt --purge autoremove elasticsearch 移除設定檔<BR>
          7$sudo rm -rf /etc/elasticsearch  移除安裝資料<BR>
          8$sudo rm -rf /var/lib/elasticsearch/ 移除安裝資料<BR>
          <div>&nbsp</div>
          <U>install kibana</U><BR>
          https://www.elastic.co/guide/en/kibana/8.1/deb.html#deb-repo
          1$wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg<BR>
          2$sudo apt-get install apt-transport-https<BR>
          3$echo "deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/8.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-8.x.list<BR>
          4$sudo apt-get update && sudo apt-get install kibana<BR>
          5$/usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana ==> 產出kibana token<BR>
          6$sudo /bin/systemctl enable kibana.service<BR>
          7$sudo systemctl start kibana.service<BR>
          8$啟動http://localhost:5601，並輸入上述步驟#5的token<BR>
          9$執行/usr/share/kibana/bin/kibana-verification-code ==> 產生六碼AuthCodeC<BR>
          10$回到網站輸入六碼AuthCode，結束<BR>
          11使用elastic/password登入<BR>
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          elasticsearch<BR>token base api-key authentication
        </div>
        <div class="col py-3 border bg-light">
          
        </div>
      </div>
      <div class="row">
        <div class="col-3 py-3 border bg-light">
          Docker sample(For WSL2)<BR>
        </div>
        <div class="col py-3 border bg-light">
          微軟預設安裝會失敗，要用以下方式安裝<BR>
          $ curl -fsSL https://get.docker.com -o get-docker.sh<BR>
          $ sudo sh get-docker.sh<BR>
          $ sudo service docker start<BR>
        </div>
      </div>
    </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  </body>
</html>
